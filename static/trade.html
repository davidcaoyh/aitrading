<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://bootswatch.com/cosmo/bootstrap.min.css">
    <link rel="stylesheet" href="/static/trading_styles.css">
    <link rel="icon" href="/static/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/static/trading_js.js"></script>
    <script src="/static/orderPreview_js.js"></script>
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
    <title>Trade Request</title>
</head>
<body>

<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">Applied Investments Group 12 (UESF00120002)</a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1" aria-expanded="false"
             style="height: 1px;">
            <ul class="nav navbar-nav navbar-right">
                <li><button type="submit" class="btn btn-default">About</button></li>
                <li><button type="submit" class="btn btn-default">Help</button></li>
                <li><button type="submit" class="btn btn-default">Logout</button></li>
            </ul>
        </div>
    </div>
</nav>

<div id="portfolio_container" class="container">
    <div id="portfolio_panel" class="panel panel-info">
        <div class="panel-heading">
            <h2>Your Portfolio</h2>
        </div>
        <div class="panel-body">
            <p id="portfolio-update-date">Last Updated:</p>
            <h3>Securities</h3>
            <table class="rwd-table table table-striped table-hover">
                <tbody id="portfolio-table">
                <tr>
                    <th>Currency</th>
                    <th>Ticker</th>
                    <th>ISIN</th>
                    <th>Security Name</th>
                    <th>Shares</th>
                    <th>Price</th>
                    <th>Total</th>
                    <th></th>
                </tr>
                <tr>
                    <td>CAD</td>
                    <td>ABCDE</td>
                    <td>US1234567890</td>
                    <td>A Fake Security Incorporated</td>
                    <td>10,000</td>
                    <td>$10.00</td>
                    <td>$100,000</td>
                    <td>
                        <button type="button" class="btn btn-xs btn-info">Sell</button>
                    </td>
                </tr>
                </tbody>
            </table>
            <h3>Cash</h3>
            <div style="width: 25%">
                <ul class="list-group">
                <li class="list-group-item">
                    <b>CAD: </b>$125,000.00
                </li>
                <li class="list-group-item">
                    <b>USD: </b>$125,000.00
                </li>
            </ul>
            </div>

        </div>
    </div>
</div>

<div id="form_container" class="container">
    <div id="form_panel" class="panel panel-primary">
        <div class="panel-heading">
            <h2>Trade details</h2>
        </div>
        <div class="panel-body">
            <form id="trade_form" class="form-inline" autocomplete="off">
                <fieldset>
                    <div class="alert alert-dismissible alert-danger" style="display: none">
                        <button type="button" class="close" onclick="$(this).parent().hide(500)">&times;</button>
                        <h4>Oh snap!</h4>
                        <p id="trade_error"></p>
                    </div>
                    <div id="currency_group" class="form-group">
                        <label for="currency" class="control-label">Currency</label>
                        <br>
                        <select id="currency" class="form-control" onchange="currencyHandler()">
                            <option disabled selected style="display: none"></option>
                            <option value="CAD">CAD</option>
                            <option value="USD">USD</option>
                        </select>
                    </div>

                    <div id="ticker_group" class="form-group">
                        <label for="ticker" class="control-label">Ticker</label>
                        <br>
                        <div class="input-group">
                            <input id="ticker" type="text" class="form-control" maxlength="6" placeholder="ABC"
                                   oninput="tickerInputHandler($(this))">
                            <div class="input-group-btn">
                                <button id="ticker_btn" class="btn btn-primary" type="button" onclick="searchByTicker()"
                                        disabled="disabled">
                                    <span id="ticker_search_icon" class="glyphicon glyphicon-search"></span>
                                    <div id="ticker_loader" class="loader" style="display: none"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="isin_group" class="form-group">
                        <label for="isin" class="control-label">ISIN</label>
                        <br>
                        <div class="input-group">
                            <input id="isin" type="text" class="form-control" maxlength="13" placeholder="US1234567890"
                                   oninput="isinInputHandler($(this))">
                            <div class="input-group-btn">
                                <button id="isin_btn" class="btn btn-primary" type="button" onclick="searchByIsin()"
                                        disabled="disabled">
                                <span id="isin_search_icon" class="glyphicon glyphicon-search"
                                      style="display: inline-block"></span>
                                    <div id="isin_loader" class="loader" style="display: none"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="sec_name_group" class="form-group">
                        <label for="sec_name" class="control-label">Security Name</label>
                        <br>
                        <textarea id="sec_name" rows="1" class="form-control" oninput="secNameInputHandler($(this))"
                                  style="resize: none;"></textarea>
                    </div>

                    <br class="hidden-xs">
                    <br class="hidden-xs">

                    <div id="buy_sell_group" class="form-group">
                        <label for="buy_sell" class="control-label">Buy/Sell</label>
                        <br>
                        <select id="buy_sell" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option>BUY</option>
                            <option>SELL</option>
                        </select>
                    </div>

                    <div id="shares_group" class="form-group">
                        <label for="shares" class="control-label">Shares</label>
                        <br>
                        <input id="shares" type="number" class="form-control" min="1" step="1"
                               oninput="sharesInputHandler($(this))">
                    </div>

                    <div id="price_group" class="form-group">
                        <label for="price" class="control-label">Price</label>
                        <br>
                        <div class="input-group">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-usd"></span></span>
                            <!-- Using tel, since when using "number", NaN results in empty value-->
                            <input id="price" type="tel" class="form-control" oninput="priceInputHandler($(this))">
                        </div>
                    </div>

                    <div id="mkt_limit_group" class="form-group">
                        <label for="mkt_limit" class="control-label">MKT/LIMIT</label>
                        <br>
                        <select id="mkt_limit" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option value="MKT">MKT</option>
                            <option value="LIMIT">LIMIT</option>
                        </select>
                    </div>

                    <div id="order_type_group" class="form-group">
                        <label for="order_type" class="control-label">Order Type</label>
                        <br>
                        <select id="order_type" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option value="GTC">GTC</option>
                            <option value="DAY">DAY</option>
                            <option value="IOC">IOC</option>
                            <option value="FOK">FOK</option>
                            <option value="AON">AON</option>
                        </select>
                    </div>

                    <div id="total_group" class="form-group">
                        <label for="total" class="control-label">Total</label>
                        <br>
                        <div class="input-group">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-usd"></span></span>
                            <input id="total" class="form-control" value="0.00" readonly>
                        </div>
                    </div>

                    <br>
                    <br class="hidden-xs">

                    <button id="add_trade_btn" class="btn btn-primary btn-block" disabled onclick="addTrade()">
                        Add Trade
                    </button>

                </fieldset>
            </form>
        </div>
    </div>
</div>

<div id="order_preview_container" class="container" style="display: none;">
    <div class="panel panel-success">
        <div class="panel-heading">
            <h2>Order Preview</h2>
        </div>
        <div class="panel-body">

            <div class="alert alert-dismissible alert-danger" style="display: none">
                <button type="button" class="close">&times;</button>
                <h4>Oh snap!</h4>
                <p id="preview_error"></p>
            </div>
            <div class="alert alert-dismissible alert-warning" style="display: none">
                <button type="button" class="close">&times;</button>
                <h4>Warning!</h4>
                <p id="preview_warning"></p>
            </div>

            <h3 style="margin-top: 0">Securities</h3>

            <table class="rwd-table table table-striped table-hover">
                <tbody id="preview_table">
                <tr>
                    <th>Currency</th>
                    <th>Ticker</th>
                    <th>ISIN</th>
                    <th>Security Name</th>
                    <th>Buy/Sell</th>
                    <th>Shares</th>
                    <th>Price</th>
                    <th>MKT/LIMIT</th>
                    <th>Order Type</th>
                    <th>Total</th>
                    <th></th>
                </tr>
                </tbody>
            </table>

            <h3 style="margin-top: 30px">Cash</h3>
            <p id="fx_info"></p>
            <table class="rwd-table table table-striped table-hover" style="table-layout: fixed">
                <tbody id="cash_recap">
                <tr>
                    <th>Currency</th>
                    <th>Opening</th>
                    <th>Total Buy</th>
                    <th>Total Sell</th>
                    <th>Conversion
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                    </th>
                    <th>Net Change</th>
                    <th>Closing Balance</th>
                </tr>
                <tr id="CAD_recap">
                    <td data-th="Currency">CAD</td>
                    <td data-th="Opening"></td>
                    <td data-th="Buys"></td>
                    <td data-th="Sells"></td>
                    <td data-th="Conversion">
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="conversion-tooltip glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                        <div class="input-group">
                            <span class="input-group-addon input-sm"><span
                                    class="glyphicon glyphicon-usd"></span></span>
                            <input id="CAD_conv" type="tel" class="form-control input-sm" title="CAD Currency"
                                   oninput="convertCash($(this), 'CAD', 'USD')">
                        </div>
                    </td>
                    <td data-th="Net"></td>
                    <td data-th="Closing"></td>
                </tr>
                <tr id="USD_recap">
                    <td data-th="Currency">USD</td>
                    <td data-th="Opening"></td>
                    <td data-th="Buys"></td>
                    <td data-th="Sells"></td>
                    <td data-th="Conversion">
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="conversion-tooltip glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                        <div class="input-group">
                            <span class="input-group-addon input-sm"><span
                                    class="glyphicon glyphicon-usd"></span></span>
                            <input id="USD_conv" type="tel" class="form-control input-sm" title="USD Currency"
                                   oninput="convertCash($(this), 'USD', 'CAD')">
                        </div>
                    </td>
                    <td data-th="Net"></td>
                    <td data-th="Closing"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>