<!DOCTYPE html>
<html lang="en">
<head>
    <title>Trade Request</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://bootswatch.com/cosmo/bootstrap.min.css">
    <link rel="stylesheet" href="/static/trading_styles.css">
    <link rel="icon" href="/static/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/static/trading_js.js"></script>
    <script src="/static/orderPreview_js.js"></script>
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
    <noscript>
        <meta http-equiv="refresh" content="0; url=./noscript" />
    </noscript>
</head>
<body>

<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">AI-Trading Group 12</a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1" aria-expanded="false"
             style="height: 1px;">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#" class="no-focus-outline" data-toggle="modal" data-target="#about_modal">About</a></li>
                <li><a href="#" class="no-focus-outline">Logout</a></li>
            </ul>
        </div>
    </div>
</nav>

<div id="about_modal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">About</h4>
            </div>
            <div class="modal-body">
                <p>Welcome to AI-Trading! This application was designed to help facilitate the execution of trades for
                    the Applied Investments (FINE 541) class at McGill. There are four main panels in the application:
                </p>
                <ol>
                    <li><b>Group Info:</b> Displays the trading supervisor(s), all group members and
                        <span class="label label-default">the currently active trader</span>
                    </li>
                    <li><b>Your Portfolio:</b> Pulls the latest portfolio info straight from CIBC BNY Mellon. Each row
                        has
                        a
                        <button type="button" class="btn btn-xs btn-info">Sell</button>
                        button to populate the Trade Details panel with the security's info.
                    </li>
                    <li><b>Trade Details:</b> Allows you to search
                        <button class="btn btn-primary btn-xs" type="button">
                            <span class="glyphicon glyphicon-search"></span></button>
                        for security information by ticker or ISIN. The security's ticker, ISIN, name and last close price are
                        pulled from <a href="http://www.morningstar.co.uk/uk/" target="_blank">Morningstar UK</a> (Yes,
                        UK. It was the only website I could find with publicly available ISIN
                        numbers). Then fill in the remaining details of the trade and add it to the preview.
                    </li>
                    <li><b>Order Preview:</b> Shows the pending orders, allowing the user to edit
                        <button type="button" class="btn btn-xs btn-success"><span
                                class="glyphicon glyphicon-pencil"></span></button>
                        or delete
                        <button type="button" class="btn btn-xs btn-success"><span
                                class="glyphicon glyphicon-remove"></span></button>
                        any entry and also
                        specify currency conversion instructions (FX rates are pulled from <a href="http://fixer.io/"
                                                                                              target="_blank">fixer.io</a>).
                        Calculates an estimate of the
                        remaining cash in each currency.
                    </li>
                </ol>
                <p>Once you submit, the application sends an email to the supervisor with all other group members CCed
                    outlining the executed trades and currency conversion instructions if applicable.
                    <b>Please verify this email and notify the supervisor if any information is missing or
                        incorrect.</b>
                </p>
                <br>
                <p>If you are experiencing any problems using the application or are interested in how it was built,
                    feel free to contact me or check out the source code at <a
                            href="https://github.com/kareemhalabi/ai-trading" target="_blank">https://github.com/kareemhalabi/ai-trading</a>
                </p>
                <br>
                <p>Cheers,<br>Kareem Halabi<br><a href="mailto:kareem.halabi@mail.mcgill.ca" target="_top">kareem.halabi@mail.mcgill.ca</a>
                </p>

            </div>
        </div>
    </div>
</div>

<div id="group_info_container" class="container">
    <div id="group_info_panel" class="panel panel-default">
        <div class="panel-heading">
            <h2>Group Info<span style="float: right">
                <button class="btn btn-default no-focus-outline" data-toggle="collapse" data-target="#group_info_panel_body">Show/Hide
                </button>
            </span></h2>
        </div>
        <div id="group_info_panel_body" class="panel-body collapse in">
            <h3 style="margin-top: 0">Supervisor</h3>
            <ul class="list-group">
                <li class="list-group-item">
                    <p>Ken Lester<span style="float: right">klester@lesterasset.com</span></p>
                </li>
            </ul>
            <h3>Account</h3>
            <ul class="list-group">
                <li class="list-group-item">
                    <p>Group 12<span style="float: right">UESF00120002</span></p>
                </li>
            </ul>
            <h3>Members</h3>
            <ul class="list-group">
                <li class="list-group-item active">
                    <p>Kareem Halabi<span class="hidden-xs" style="float: right">kareem.halabi@mail.mcgill.ca</span></p>
                </li>
                <li class="list-group-item">
                    <p>Qitong Deng<span class="hidden-xs" style="float: right">qitong.deng@mail.mcgill.ca</span></p>
                </li>
                <li class="list-group-item">
                    <p>Jaskrit Singh<span class="hidden-xs" style="float: right">jaskrit.singh@mail.mcgill.ca</span></p>
                </li>
                <li class="list-group-item">
                    <p>Louis Lee<span class="hidden-xs" style="float: right">chen-in.lee@mail.mcgill.ca</span></p>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="portfolio_container" class="container">
    <div id="portfolio_panel" class="panel panel-info">
        <div class="panel-heading">
            <h2>Your Portfolio <span style="float: right">
                <button class="btn btn-info no-focus-outline" data-toggle="collapse" data-target="#portfolio_panel_body">Show/Hide
                </button>
            </span></h2>
        </div>
        <div id="portfolio_panel_body" class="panel-body collapse in">
            <p id="portfolio-update-date">Last Updated:</p>
            <h3>Securities</h3>
            <table class="rwd-table rwd-table-info table table-striped table-hover">
                <tbody id="portfolio-table">
                <tr>
                    <th>Currency</th>
                    <th>Ticker</th>
                    <th>ISIN</th>
                    <th>Security Name</th>
                    <th>Shares</th>
                    <th>Price</th>
                    <th>Total</th>
                    <th></th>
                </tr>
                <tr>
                    <td>CAD</td>
                    <td>ABCDE</td>
                    <td>US1234567890</td>
                    <td>A Fake Security Incorporated</td>
                    <td>10,000</td>
                    <td>$10.00</td>
                    <td>$100,000</td>
                    <td>
                        <button type="button" class="btn btn-xs btn-info">Sell</button>
                    </td>
                </tr>
                </tbody>
            </table>
            <h3>Cash</h3>
            <ul class="list-group">
                <li class="list-group-item">
                    <b>CAD: </b> <span style="float:right">$125,000.00</span>
                </li>
                <li class="list-group-item">
                    <b>USD: </b> <span style="float:right">$125,000.00</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="form_container" class="container">
    <div id="form_panel" class="panel panel-primary">
        <div class="panel-heading">
            <h2>Trade details</h2>
        </div>
        <div class="panel-body">
            <form id="trade_form" class="form-inline" autocomplete="off">
                <fieldset>
                    <div class="alert alert-dismissible alert-danger" style="display: none">
                        <button type="button" class="close" onclick="$(this).parent().hide(500)">&times;</button>
                        <h4>Oh snap!</h4>
                        <p id="trade_error"></p>
                    </div>
                    <div id="currency_group" class="form-group">
                        <label for="currency" class="control-label">Currency</label>
                        <br>
                        <select id="currency" class="form-control" onchange="currencyHandler()">
                            <option disabled selected style="display: none"></option>
                            <option value="CAD">CAD</option>
                            <option value="USD">USD</option>
                        </select>
                    </div>

                    <div id="ticker_group" class="form-group">
                        <label for="ticker" class="control-label">Ticker</label>
                        <br>
                        <div class="input-group">
                            <input id="ticker" type="text" class="form-control" maxlength="6" placeholder="ABC"
                                   oninput="tickerInputHandler($(this))">
                            <div class="input-group-btn">
                                <button id="ticker_btn" class="btn btn-primary" type="button" onclick="searchByTicker()"
                                        disabled="disabled">
                                    <span id="ticker_search_icon" class="glyphicon glyphicon-search"></span>
                                    <div id="ticker_loader" class="loader" style="display: none"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="isin_group" class="form-group">
                        <label for="isin" class="control-label">ISIN</label>
                        <br>
                        <div class="input-group">
                            <input id="isin" type="text" class="form-control" maxlength="13" placeholder="US1234567890"
                                   oninput="isinInputHandler($(this))">
                            <div class="input-group-btn">
                                <button id="isin_btn" class="btn btn-primary" type="button" onclick="searchByIsin()"
                                        disabled="disabled">
                                <span id="isin_search_icon" class="glyphicon glyphicon-search"
                                      style="display: inline-block"></span>
                                    <div id="isin_loader" class="loader" style="display: none"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="sec_name_group" class="form-group">
                        <label for="sec_name" class="control-label">Security Name</label>
                        <br>
                        <textarea id="sec_name" rows="1" class="form-control" oninput="secNameInputHandler($(this))"
                                  style="resize: none;"></textarea>
                    </div>

                    <br class="hidden-xs">
                    <br class="hidden-xs">

                    <div id="buy_sell_group" class="form-group">
                        <label for="buy_sell" class="control-label">Buy/Sell</label>
                        <br>
                        <select id="buy_sell" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option>BUY</option>
                            <option>SELL</option>
                        </select>
                    </div>

                    <div id="shares_group" class="form-group">
                        <label for="shares" class="control-label">Shares</label>
                        <br>
                        <input id="shares" type="number" class="form-control" min="1" step="1"
                               oninput="sharesInputHandler($(this))">
                    </div>

                    <div id="price_group" class="form-group">
                        <label for="price" class="control-label">Price</label>
                        <br>
                        <div class="input-group">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-usd"></span></span>
                            <!-- Using tel, since when using "number", NaN results in empty value-->
                            <input id="price" type="tel" class="form-control" oninput="priceInputHandler($(this))">
                        </div>
                    </div>

                    <div id="mkt_limit_group" class="form-group">
                        <label for="mkt_limit" class="control-label">MKT/LIMIT</label>
                        <br>
                        <select id="mkt_limit" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option value="MKT">MKT</option>
                            <option value="LIMIT">LIMIT</option>
                        </select>
                    </div>

                    <div id="order_type_group" class="form-group">
                        <label for="order_type" class="control-label">Order Type</label>
                        <br>
                        <select id="order_type" class="form-control" onchange="selectHandler($(this))">
                            <option disabled selected style="display: none"></option>
                            <option value="GTC">GTC</option>
                            <option value="DAY">DAY</option>
                            <option value="IOC">IOC</option>
                            <option value="FOK">FOK</option>
                            <option value="AON">AON</option>
                        </select>
                    </div>

                    <div id="total_group" class="form-group">
                        <label for="total" class="control-label">Total</label>
                        <br>
                        <div class="input-group">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-usd"></span></span>
                            <input id="total" class="form-control" value="0.00" readonly>
                        </div>
                    </div>

                    <br>
                    <br class="hidden-xs">

                    <button id="add_trade_btn" class="btn btn-primary btn-block" disabled onclick="addTrade()">
                        Add Trade
                    </button>

                </fieldset>
            </form>
        </div>
    </div>
</div>

<div id="order_preview_container" class="container" style="display: none;">
    <div class="panel panel-success">
        <div class="panel-heading">
            <h2>Order Preview</h2>
        </div>
        <div class="panel-body">

            <div class="alert alert-dismissible alert-danger" style="display: none">
                <button type="button" class="close">&times;</button>
                <h4>Oh snap!</h4>
                <p id="preview_error"></p>
            </div>
            <div class="alert alert-dismissible alert-warning" style="display: none">
                <button type="button" class="close">&times;</button>
                <h4>Warning!</h4>
                <p id="preview_warning"></p>
            </div>

            <h3 style="margin-top: 0">Securities</h3>

            <table class="rwd-table rwd-table-success table table-striped table-hover">
                <tbody id="preview_table">
                <tr>
                    <th>Currency</th>
                    <th>Ticker</th>
                    <th>ISIN</th>
                    <th>Security Name</th>
                    <th>Buy/Sell</th>
                    <th>Shares</th>
                    <th>Price</th>
                    <th>MKT/LIMIT</th>
                    <th>Order Type</th>
                    <th>Total</th>
                    <th></th>
                </tr>
                </tbody>
            </table>

            <h3 style="margin-top: 30px">Cash</h3>
            <p id="fx_info"></p>
            <table class="rwd-table rwd-table-success table table-striped table-hover" style="table-layout: fixed">
                <tbody id="cash_recap">
                <tr>
                    <th>Currency</th>
                    <th>Opening</th>
                    <th>Total Buy</th>
                    <th>Total Sell</th>
                    <th>Conversion
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                    </th>
                    <th>Net Change</th>
                    <th>Closing Balance</th>
                </tr>
                <tr id="CAD_recap">
                    <td data-th="Currency">CAD</td>
                    <td data-th="Opening"></td>
                    <td data-th="Buys"></td>
                    <td data-th="Sells"></td>
                    <td data-th="Conversion">
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="conversion-tooltip glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                        <div class="input-group">
                            <span class="input-group-addon input-sm"><span
                                    class="glyphicon glyphicon-usd"></span></span>
                            <input id="CAD_conv" type="tel" class="form-control input-sm" title="CAD Currency"
                                   oninput="convertCash($(this), 'CAD', 'USD')">
                        </div>
                    </td>
                    <td data-th="Net"></td>
                    <td data-th="Closing"></td>
                </tr>
                <tr id="USD_recap">
                    <td data-th="Currency">USD</td>
                    <td data-th="Opening"></td>
                    <td data-th="Buys"></td>
                    <td data-th="Sells"></td>
                    <td data-th="Conversion">
                        <span data-toggle="tooltip" data-placement="top" data-html="true"
                              class="conversion-tooltip glyphicon glyphicon-question-sign"
                              title="<p style='text-align: left'>A negative value indicates the source currency</p>
                              <p style='text-align: left'>A positive value indicates the target currency<p>"
                        ></span>
                        <div class="input-group">
                            <span class="input-group-addon input-sm"><span
                                    class="glyphicon glyphicon-usd"></span></span>
                            <input id="USD_conv" type="tel" class="form-control input-sm" title="USD Currency"
                                   oninput="convertCash($(this), 'USD', 'CAD')">
                        </div>
                    </td>
                    <td data-th="Net"></td>
                    <td data-th="Closing"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>